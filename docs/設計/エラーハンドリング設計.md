## エラーハンドリング方針

- **入力エラー**：入力欄下に表示する。
- **データ取得エラー**：該当セクション内に表示する。
- **システムエラー**：`error.vue` で表示する。（画面全体のデータ取得に失敗した場合など）。

---

## エラーモデル定義

```ts
/** 内部API共通レスポンス構造 */
type ApiResult<T> = T | { error: ApiError }

/** エラー情報 */
type ApiError = {
  code: ErrorCode
  message: string
}

/** エラーコード定義 */
type ErrorCode = 'BAD_REQUEST' | 'NOT_FOUND' | 'UPSTREAM_ERROR' | 'NETWORK_ERROR' | 'INTERNAL_ERROR'
```

- **成功時** → 正常データのみ返却。
- **失敗時** → `error`を持つオブジェクトを返却。

---

## 再試行ルール

- **自動再試行**：通信エラーまたは一時的な上流エラーの場合、1回のみ自動で再試行する。
- **手動再試行**：ユーザー操作（再検索・再読み込みなど）で再実行できる状態を保つ。
- **入力エラー**：再試行は行わず、ユーザーの修正を待つ。

---

## 画面別適用表

### TOP（/）

- 入力エラー：SearchFormの各入力欄下に表示
- データ取得エラー：NearbyHotCarouselセクション内に表示
- システムエラー：`error.vue`（ページ初期処理が成立しない場合）

### 検索結果（/shops/）

- 入力エラー：SearchFormの各入力欄下に表示
- データ取得エラー：ResultList（一覧）/ResultMap（地図）の該当セクション内に表示
- システムエラー：`error.vue`（初回SSRの結果取得が不成立の場合）

### 詳細（/shops/[id]）

- 入力エラー：該当なし（フォーム入力なし）
- データ取得エラー：メインコンテンツ（ShopHeader/InfoGrid/Map）のセクション内に表示（対象なし含む）
- システムエラー：`error.vue`（初回SSRの詳細取得が不成立の場合）

---
