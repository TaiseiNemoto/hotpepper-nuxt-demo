## メソッド

GET

## パス

/api/hp/shops/search

## 用途

- 検索結果ページ：一覧取得
- TOPページ：周辺のホットな飲食店

## 上流（HotPepper）

- エンドポイント：`https://webservice.recruit.co.jp/hotpepper/gourmet/v1/`

## リクエスト

### クエリパラメータ

| 名前           |   必須 | 型            | 既定値 | 制約/ルール                                         | 説明                                              | 上流マッピング              |
| -------------- | -----: | ------------- | ------ | --------------------------------------------------- | ------------------------------------------------- | --------------------------- |
| `q`            |   任意 | string        | なし   | 全角/半角スペースで AND 検索                        | フリーワード                                      | `keyword`                   |
| `genres`       |   任意 | string[]      | `[]`   | **最大2件**（超過は切捨て）                         | ジャンルコード                                    | `genre`（カンマ結合）       |
| `areas.large`  |   任意 | string[]      | `[]`   | **最大3件**                                         | 大エリアコード                                    | `large_area`（カンマ結合）  |
| `areas.middle` |   任意 | string[]      | `[]`   | **最大5件**                                         | 中エリアコード                                    | `middle_area`（カンマ結合） |
| `areas.small`  |   任意 | string[]      | `[]`   | **最大5件**                                         | 小エリアコード                                    | `small_area`（カンマ結合）  |
| `lat`          | 任意\* | number        | なし   | `lng` と**同時指定**で有効                          | 位置検索：緯度                                    | `lat`                       |
| `lng`          | 任意\* | number        | なし   | `lat` と**同時指定**で有効                          | 位置検索：経度                                    | `lng`                       |
| `range`        | 任意\* | 1\|2\|3\|4\|5 | 3      | `lat/lng` 指定時のみ使用（300/500/1000/2000/3000m） | 位置検索の半径                                    | `range`                     |
| `order`        |   任意 | 1\|2\|3\|4    | 4      | 位置検索時は**距離順に固定**（指定は無視され得る）  | 並び順（1:かな/2:ジャンル/3:小エリア/4:おすすめ） | `order`                     |
| `page`         |   任意 | number        | 1      | 1以上の整数に正規化                                 | ページ番号（1始まり）                             | `start` に変換              |
| `perPage`      |   任意 | number        | 20     | **1〜100**にクランプ                                | 1ページ件数                                       | `count`                     |

### ボディ構造

```ts
type SearchResponse = {
  total: number // 総件数（results_available）
  start: number // 返却開始位置（results_start）
  returned: number // 返却件数（results_returned）
  shops: ShopSummary[]
}

type ShopSummary = {
  id: string
  name: string
  address: string
  lat: number
  lng: number
  genre: { code: string; name: string }
  catch?: string
  photo?: { s?: string; m?: string; l?: string } // HotPepperの photo.pc.*
  urlPc?: string // HotPepperの urls.pc
}
```

### フィールド説明

| フィールド                | 型      | 説明                     | 元データ                    |
| ------------------------- | ------- | ------------------------ | --------------------------- |
| `total`                   | number  | ヒット総件数             | `results.results_available` |
| `start`                   | number  | 今回の先頭インデックス   | `results.results_start`     |
| `returned`                | number  | 今回返却件数             | `results.results_returned`  |
| `shops[].id`              | string  | 店舗ID                   | `shop[].id`                 |
| `shops[].name`            | string  | 店舗名                   | `shop[].name`               |
| `shops[].address`         | string  | 住所                     | `shop[].address`            |
| `shops[].lat` / `lng`     | number  | 緯度/経度（地図用）      | `shop[].lat` / `shop[].lng` |
| `shops[].genre.code/name` | string  | ジャンル                 | `shop[].genre.code/name`    |
| `shops[].catch`           | string? | キャッチコピー           | `shop[].catch`              |
| `shops[].photo.s/m/l`     | string? | カード/一覧で使う画像URL | `shop[].photo.pc.{s,m,l}`   |
| `shops[].urlPc`           | string? | 公式詳細ページURL        | `shop[].urls.pc`            |
