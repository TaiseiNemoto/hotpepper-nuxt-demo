# 3.2 画面実装チェックリスト

WBS「3.実装 > 3.2モック開発（見た目）」の実装タスク一覧（推奨実装順）

**重要**: このフェーズでは静的な画面実装（モック）を行い、API結合は3.3フェーズで実施します。

**テスト方針**: 各コンポーネント・ページ実装後に、プロジェクトのテスト戦略（`docs/設計/テスト戦略設計.md`）に沿ってテストを作成します。

---

## 1. スタイリング基盤セットアップ

### 1.1 Tailwind CSS 導入

- [x] `@nuxtjs/tailwindcss` インストール
  - [x] `yarn add -D @nuxtjs/tailwindcss`
  - [x] `nuxt.config.ts` の `modules` に `@nuxtjs/tailwindcss` 追加
- [x] `tailwind.config.ts` 作成
  - [x] カラーパレット定義（プライマリ/セカンダリ/エラー/成功/警告）
  - [x] カスタムブレークポイント設定（デスクトップ優先）
  - [x] フォント設定
- [x] `app/assets/css/main.css` 作成（グローバルスタイル）
  - [x] Tailwind ディレクティブ（`@tailwind base/components/utilities`）
  - [x] カスタムCSS変数定義（必要に応じて）
  - [x] リセットCSS・ベーススタイル
- [x] `nuxt.config.ts` に `css` 配列追加（`~/assets/css/main.css` を指定）

### 1.2 グローバルスタイル設定

- [x] フォント読み込み設定（Google Fonts等、必要に応じて）
- [x] `app.vue` でグローバルスタイルの適用確認

---

## 2. レイアウト実装

### 2.1 ルートレイアウト

- [x] `app/app.vue` 更新
  - [x] `<NuxtLayout>` と `<NuxtPage />` でページをレンダリング
  - [x] グローバルなメタタグ設定（`useHead` で初期設定）

### 2.2 デフォルトレイアウト

- [x] `app/layouts/default.vue` 実装
  - [x] AppHeader, AppFooter, メインコンテンツの配置
  - [x] `<slot />` でページコンテンツを挿入
  - [x] 背景色とテキスト色の設定（`bg-gray-50 text-gray-900`）

---

## 3. 共通コンポーネント実装

### 3.1 Header コンポーネント

- [x] `app/components/AppHeader.vue` 実装
  - [x] ロゴ表示（テキスト、`<div>`タグ使用）
  - [x] ロゴをクリックでTOP（`/`）へ遷移（`NuxtLink` 使用）
  - [x] `aria-label` 属性でアクセシビリティ対応
  - [x] レスポンシブ対応
  - [x] **重要**: `<h1>`タグは使用しない（各ページで主題を表すh1を配置するため）

### 3.2 Footer コンポーネント

- [x] `app/components/AppFooter.vue` 実装
  - [x] クレジット一文表示
  - [x] HotPepper API 利用規約リンク
  - [x] レスポンシブ対応

### 3.3 ShopCard コンポーネント

- [ ] `app/components/ShopCard.vue` 実装
  - [ ] Props定義（`shop: ShopSummary` 型）
  - [ ] サムネイル画像表示（`photo.m` または `photo.s`）
  - [ ] 店名（太字・1行省略、CSS: `truncate`）
  - [ ] ジャンル（サブテキスト）
  - [ ] キャッチコピー（2行省略、CSS: `line-clamp-2`、任意）
  - [ ] カード全体をリンク化（`NuxtLink` で `/shops/{id}` へ）
  - [ ] ホバーエフェクト
  - [ ] 画像 `alt` 属性設定（`"{店名} の写真"`）
  - [ ] レスポンシブ対応
- [ ] **テスト作成**: Props表示、リンクURL、画像alt属性の確認

---

## 4. SearchForm コンポーネント実装

### 4.1 基本構造

- [x] `app/components/SearchForm.vue` 実装
  - [x] Props定義
    - `genres: Genre[]` (ジャンルマスタ)
    - `largeAreas: LargeArea[]` (大エリアマスタ)
    - `middleAreas: MiddleArea[]` (中エリアマスタ)
    - `smallAreas: SmallArea[]` (小エリアマスタ)
  - [x] Reactive state 定義
    - `keyword: string`
    - `selectedGenres: string[]`
    - `selectedLargeAreas: string[]`
    - `selectedMiddleAreas: string[]`
    - `selectedSmallAreas: string[]`

### 4.2 フォームフィールド実装

- [x] キーワード入力フィールド
  - [x] `<input type="text" v-model="keyword">`
  - [x] ラベル・プレースホルダー設定
- [x] ジャンル選択UI
  - [x] ドロップダウンまたはタグ形式（複数選択可）
  - [x] 選択済みジャンルをバッジ表示
  - [x] 削除ボタン実装（バッジクリックで削除）
  - [x] 選択上限チェック（最大2件）
- [x] エリア選択UI（3階層: 大/中/小）
  - [x] 大エリア選択ドロップダウン
  - [x] 中エリア選択ドロップダウン（大エリア選択時のみ活性）
  - [x] 小エリア選択ドロップダウン（中エリア選択時のみ活性）
  - [x] 親子関係の自動補完ロジック
    - [x] 小エリア選択時、親の中・大エリアを自動選択
    - [x] 親エリア削除時、配下の中・小エリアを自動削除
  - [x] 選択上限チェック（大3件/中5件/小5件）
  - [x] 選択済みエリアをバッジ表示

### 4.3 検索実行処理

- [x] 検索ボタン実装
  - [x] クリック時に入力値を正規化（空値除外、トリム）
  - [x] URLクエリを構築
    - `q`: キーワード
    - `genres`: ジャンルコード（カンマ区切り）
    - `area_l`: 大エリアコード（カンマ区切り）
    - `area_m`: 中エリアコード（カンマ区切り）
    - `area_s`: 小エリアコード（カンマ区切り）
  - [x] `navigateTo('/shops?...')` で検索結果ページへ遷移
- [x] バリデーション（クライアントサイド）
  - [x] 空値チェック（全フィールドが空の場合は検索不可）
  - [x] 文字数制限（キーワード最大100文字等）

### 4.4 テスト作成

- [x] **テスト作成**:
  - 入力・選択操作の動作確認
  - エリア階層関係の自動補完動作
  - 検索ボタンクリック時の遷移URL確認
  - バリデーションエラー表示

---

## 5. TOPページ実装

### 5.1 Hero コンポーネント

- [x] `app/components/HeroSection.vue` 実装
  - [x] キャッチコピー（H1タグ）
  - [x] 説明文（サブテキスト）
  - [x] 背景画像またはグラデーション（任意）
  - [x] レスポンシブ対応
- [x] **テスト作成**: キャッチコピー、説明文の表示確認

### 5.2 NearbyHotCarousel コンポーネント

- [x] `app/components/NearbyHotCarousel.vue` 実装
  - [x] セクションタイトル（「周辺のホットな飲食店」）
  - [x] 横スクロールカルーセル実装
    - [x] 前へ/次へボタン
    - [x] CSS Flexbox + scroll-snap で横スクロール
    - [x] タッチスワイプ対応（ブラウザネイティブのスクロールで実現）
  - [x] ShopCard を使って店舗表示（最大10件）
  - [x] 状態表示
    - [x] 位置情報未許可/失敗: セクション非表示
    - [x] 取得中: スケルトンカード表示（`v-if="isLoading"`）
    - [x] 空結果: `周辺で該当店舗が見つかりませんでした`
    - [x] エラー時: `周辺情報の取得に失敗しました`
  - [x] 位置情報取得ロジック（モック実装）
    - [x] `navigator.geolocation.getCurrentPosition` 使用
    - [x] 許可/拒否のハンドリング
    - [x] モックデータで店舗10件を表示（propsで受け取る設計）
- [x] **テスト作成**: カルーセル表示、状態遷移の確認

### 5.3 TOPページ統合

- [x] `app/pages/index.vue` 実装
  - [x] Hero コンポーネント表示
  - [x] SearchForm コンポーネント表示（モックマスタデータを渡す）
  - [x] NearbyHotCarousel コンポーネント表示
  - [x] SEO設定（`useSeoMeta` で title, description, OGP）
  - [x] モックデータ準備
    - [x] `tests/fixtures/masters.ts` からジャンル・エリアマスタ取得
    - [x] `tests/fixtures/shops.ts` から周辺店舗データ取得
- [x] **テスト作成**: コンポーネント単体テストで十分（テスト戦略に基づき、結合テストは3.3フェーズで実施）

---

## 6. 検索結果ページ実装

### 6.1 ResultList コンポーネント

- [x] `app/components/ResultList.vue` 実装
  - [x] Props定義（`shops: ShopSummary[]`, `isLoading?: boolean`, `skeletonCount?: number`）
  - [x] ShopCard を使って店舗リスト表示
  - [x] 0件時の表示（`検索条件に一致する店舗が見つかりませんでした`）
  - [x] 縦並びリストレイアウト（`<ul>/<li>` によるセマンティックなリスト構造）
  - [x] ローディング状態表示（スケルトンカード、`role="status"` によるアクセシビリティ対応）
- [x] **テスト作成**: 店舗リスト表示、0件表示、ローディング状態の確認

### 6.2 ResultMap コンポーネント

- [x] `app/components/ResultMap.vue` 実装（`.client.vue`から変更）
  - [x] Props定義（`shops: ShopSummary[]`）
  - [x] Google Maps JavaScript API 統合
    - [x] `useHead` で手動スクリプトロード
    - [x] APIキー設定（`runtimeConfig.public.googleMapsApiKey`）
    - [x] マップ初期化処理
  - [x] 店舗位置にピン（Marker）表示
  - [x] ピンクリックでポップアップ（InfoWindow）表示
    - [x] 店名（太字・1行省略、XSS対策済み）
    - [x] ジャンル（サブテキスト、XSS対策済み）
    - [x] 住所（短縮表示、XSS対策済み）
    - [x] 「詳細を見る」ボタン（`<a>` で `/shops/{id}` へ）
  - [x] ポップアップの開閉制御
    - [x] 他のピンクリック時に前のポップアップを閉じる
    - [x] 地図外クリックで閉じる
  - [x] 地図の初期位置・ズーム設定（全ピンが収まるように調整）
  - [x] スクロール操作制御（`gestureHandling: 'auto'`、デスクトップ専用のため）
  - [x] XSS脆弱性対策（HTMLエスケープ関数実装）
- [x] **テスト作成**: 表示条件、アクセシビリティ属性、状態遷移の確認
- [x] **プロジェクトルール更新**: `<ClientOnly>`使用方針をCLAUDE.mdに追加

### 6.3 Pagination コンポーネント

- [x] `app/components/PaginationControl.vue` 実装
  - [x] Props定義
    - `currentPage: number`
    - `pageCount: number`
    - `total: number`
  - [x] 「前へ」ボタン（`page > 1` のときのみ活性）
  - [x] ページ番号表示
    - [x] 現在ページは `aria-current="page"`、押下不可
    - [x] コンパクト表示（最大5つのウィンドウ: `[1] … 4 5 6 … 20`）
    - [x] 省略記号（…）は押下不可
  - [x] 「次へ」ボタン（`page < pageCount` のときのみ活性）
  - [x] 非表示条件（`total === 0` または `pageCount <= 1`）
  - [x] クリック時にEmit（`@update:page`）
- [x] **テスト作成**: ページ番号表示、ボタン活性/非活性、非表示条件の確認

### 6.4 検索結果ページ統合

- [x] `app/pages/shops/index.vue` 実装
  - [x] ページ見出し（`<h1>`タグ）表示
    - [x] 「検索結果」または動的に生成（例：「「居酒屋」の検索結果」）
  - [x] SearchForm コンポーネント表示（TOPと同じ）
  - [x] タブ切替UI（一覧/地図）
    - [x] タブボタン実装（`ref` で `activeTab` 管理）
    - [x] 既定値: 一覧タブ
    - [x] WAI-ARIA対応（role="tablist"、role="tab"、aria-selected、tabindex）
  - [x] ResultList / ResultMap の表示切替（`v-if="activeTab === 'list'"` / `v-else-if="activeTab === 'map'"`）
  - [x] ResultMap を `<ClientOnly>` でラップ（フォールバック付き）
  - [x] Pagination 表示（一覧タブ時のみ、`v-if="activeTab === 'list'"`）
  - [x] SEO設定（`useSeoMeta` で title, description、動的生成）
  - [x] URLクエリからパラメータ取得（`useRoute().query`）
  - [x] モックデータ準備
    - [x] `tests/fixtures/shops.ts` から検索結果20件生成
    - [x] ページネーション情報設定（`page: 1, pageCount: 5, total: 100`）
- [x] **テスト作成**: タブ切替、URLクエリ解析、SEO設定、アクセシビリティの確認（17テスト全て成功）

---

## 7. 詳細ページ実装

### 7.1 ShopHeader コンポーネント

- [x] `app/components/ShopHeader.vue` 実装
  - [x] Props定義（`shop: ShopDetail`）
  - [x] サムネイル画像（`photo.l`）
  - [x] 店名（`<h1>`タグ、太字・大きめ・1行省略）
  - [x] ジャンル（サブテキスト）
  - [x] キャッチコピー（2行省略、任意）
  - [x] 画像 `alt` 属性設定（`"{店名} の写真"`）
  - [x] レスポンシブ対応
- [x] **テスト作成**: 店舗情報表示、画像alt属性の確認

### 7.2 ShopInfoGrid コンポーネント

- [x] `app/components/ShopInfoGrid.vue` 実装
  - [x] Props定義（`shop: ShopDetail`）
  - [x] 基本情報の表示（グリッドレイアウト）
    - [x] 住所（`shop.address`）
    - [x] 最寄り駅（`shop.stationName`、任意）
    - [x] アクセス（`shop.access`、任意）
    - [x] 営業時間（`shop.open`）
    - [x] 定休日（`shop.close`）
    - [x] 予算（`shop.budget.name` / `shop.budget.average`）
    - [x] 禁煙・喫煙（`shop.nonSmoking`、任意）
    - [x] 駐車場（`shop.parking`、任意）
    - [x] カード（`shop.card`、任意）
    - [x] 貸切（`shop.charter`、任意）
    - [x] 個室（`shop.privateRoom`、任意）
  - [x] 空値は項目ごと非表示（`v-if`）
  - [x] ラベルとデータのペア表示（例: `住所: 東京都...`）
  - [x] レスポンシブ対応（1カラム → 2カラム）
- [x] **テスト作成**: 基本情報表示、空値項目の非表示確認

### 7.3 ShopMap コンポーネント

- [x] `app/components/ShopMap.vue` 実装
  - [x] Props定義（`lat: number, lng: number, shopName: string`）
  - [x] Google Maps JavaScript API 統合
  - [x] 店舗位置にピン（Marker）表示
  - [x] マーカーにラベル表示（店名、InfoWindow）
  - [x] 中程度のズーム設定（`zoom: 15`）
  - [x] スクロール操作制御（`gestureHandling: 'auto'`）
  - [x] レスポンシブ対応
- [x] **テスト作成**: 地図表示、ピン位置の確認
- [x] **コード共通化**: `escapeHtml`関数を`app/utils/html.ts`に抽出
- [x] **コード共通化**: Google Maps関連処理を`app/composables/useGoogleMaps.ts`に抽出

### 7.4 詳細ページ統合

- [x] `app/pages/shops/[id].vue` 実装
  - [x] ShopHeader コンポーネント表示
  - [x] アクションボタン表示
    - [x] 「公式詳細ページ」ボタン（`<a>` タグ、`target="_blank"`, `rel="noopener"`）
    - [x] `shop.urlPc` へのリンク
  - [x] ShopInfoGrid コンポーネント表示
  - [x] ShopMap コンポーネント表示（`<ClientOnly>` でラップ、フォールバック付き）
  - [x] SEO設定（`useSeoMeta` で title, description, OGP、店舗名を含む）
  - [x] URLパラメータから店舗ID取得（`useRoute().params.id`）
  - [x] モックデータ準備
    - [x] `tests/fixtures/shops.ts` から店舗詳細1件取得
  - [x] 404エラーハンドリング
    - [x] 存在しない店舗IDの場合、`throw createError({ statusCode: 404 })`
- [x] **テスト作成**: 店舗詳細表示、公式リンク、SEO設定、データ取得の確認（11テスト全て成功）

---

## 8. ドキュメント・設定

- [ ] `docs/実装計画/3.2_画面実装チェックリスト.md`: このファイル
- [ ] `README.md` 更新（画面実装の概要、コンポーネント一覧）
- [ ] Tailwind 設定のドキュメント化（`tailwind.config.js` にコメント追加）

---

## 完了条件

- [ ] すべてのチェック項目が完了
- [ ] コンポーネント・ページテストがパス（`yarn test`）
- [ ] 型チェックがパス（`yarn type-check`）
- [ ] Lintエラーなし（`yarn lint`）
- [ ] Stylelintエラーなし（`yarn lint:css`）
- [ ] ローカル環境で全画面が正しく表示されることを目視確認
- [ ] モックデータで画面遷移が正しく動作することを確認

**注**: API結合は「3.3 API結合」フェーズで実施
